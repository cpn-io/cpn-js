<!--<app-project-explorer-toolbar></app-project-explorer-toolbar>-->

<!--<div style="width: 100%; height:100%; margin-top:-42px; border: 0px solid blue">-->
<!--<div style="padding-top:42px; height:100%;; border:0px solid red">-->
<tabs #tabsComponent class="cpn-tabs">

  <tab id="Explorer panel" tabTitle="Explorer panel" [isHidden]="false">
    <nav class="navbar navbar-sm navbar-expand shadow-sm">

      <ul class="navbar-nav mr-auto">

        <div *ngIf="canCreateDeclaration(selectedNode)">
          <li class="dropdown nav-item">
            <a aria-expanded="false" aria-haspopup="true" class="dropdown-toggle nav-link" data-toggle="dropdown"
              href="#" id="navbarDropdown">
              <i class="fas fa-plus"></i>
              <span>New</span>
            </a>
            <div aria-labelledby="navbarDropdown" class="dropdown-menu shadow">
              <a (click)="onAddNode(selectedNode, 'colset')" class="dropdown-item" href="#">New Color</a>
              <a (click)="onAddNode(selectedNode, 'var')" class="dropdown-item" href="#">New Var</a>
              <a (click)="onAddNode(selectedNode, 'ml')" class="dropdown-item" href="#">New ML</a>
              <a (click)="onAddNode(selectedNode, 'globref')" class="dropdown-item" href="#">New GlobRef</a>
              <a (click)="onAddNode(selectedNode, 'block')" class="dropdown-item" href="#">New Block</a>
            </div>
          </li>
        </div>

        <li class="nav-item"><a (click)="onAddNode(selectedNode)" *ngIf="canCreate(selectedNode)" class="nav-link"
            href="#">
            <i class="fas fa-plus"></i>
            New {{getStringValueForAddingCp(selectedNode)}}</a>
        </li>

        <div *ngIf="canCreate(selectedNode) || canCreateDeclaration(selectedNode)" class="divider"></div>

        <!--<li class="nav-item"><a (click)="onEditNode(selectedNode)" *ngIf="canEditOnContextMenu(selectedNode)" class="nav-link"-->
        <!--href="#">-->
        <!--<i class="fas fa-pen"></i>Edit</a></li>-->

        <li class="nav-item"><a (click)="onDeleteNode(selectedNode)" *ngIf="canDelete(selectedNode)" class="nav-link"
            href="#">
            <i class="fas fa-minus"></i>
            Delete</a>
        </li>

        <div class="divider"></div>
        <li class="nav-item"><a (click)="onReload()" class="nav-link" href="#">Reload</a></li>
      </ul>

      <ul class="navbar-nav ml-auto">
        <li>
          <input (input)="changeFilter($event.target.value)" [value]="filterText" placeholder="Filter" type="text" />
        </li>

        <li class="nav-item">
          <a (click)="changeFilter('')" class="nav-link btn-close" href="#">
            <i class="fas fa-times"></i>
          </a>
        </li>
      </ul>

    </nav>

    <div class="workspace-container-with-tab">
      <div class="inner">
        <div class="scroll-y">
          <div class="pane" style="padding:10px">

            <!------------------->
            <!-- Tree explorer -->
            <!------------------->
            <tree-root #tree [nodes]="nodes" [options]="options" (activate)="activateNode($event)"
              (ngModelChange)="treeModelChanged($event)">
              <ng-template #treeNodeTemplate let-node let-index="index">

                <div [ngClass]="node.data.classes">

                  <table class="table-textarea">
                    <tr>
                      <td>
                        <span *ngIf="canCollapse(node)" class="toggle-children-wrapper">
                          <span
                            [class]="openedLabel[node.id] ? 'toggle-children-wrapper-expanded' : 'toggle-children-wrapper-collapsed'"
                            (click)="onNodeArrowClick($event, node)">
                            <span class="toggle-children"></span>
                          </span>
                        </span>
                        <span *ngIf="node.parent.parent === null">Project: </span>
                      </td>

                      <td class="node"
                        [ngClass]="{'node-highlight-bottom': isHighlightBottom(node.id), 'node-highlight-all': isHighlightAround(node.id)}">

                        <!-- {{getLabel(node)}} - {{openedLabel[node.id] ? true : false}} -->

                        <!-- <div innerHtml="{{getLabel(node) | colorDeclarations}}"></div> -->
                        <!-- <div [innerHTML]="getLabel(node) | colorDeclarations | safeHtml"></div> -->

                        <!-- <div 
                          *ngIf="!openedLabel[node.id]"
                          (click)="onNodeLabelClick($event, node)"
                          [contentEditable]="openedLabel[node.id] || (editableNode === node)"
                          [innerHTML]="getLabel(node) | colorDeclarations | safeHtml">
                        </div> -->

                        <div [id]="'textinpfield_' + node.id" class="editablenode"
                          (click)="onNodeLabelClick($event, node)" (focusout)="saveEditedData($event, node)"
                          [contentEditable]="canEdit(node) && (openedLabel[node.id] || (editableNode === node))"
                          [innerHTML]="getLabel(node) | colorDeclarations | safeHtml">
                        </div>
                      </td>
                    </tr>
                  </table>

                  <!-- <div *ngIf="canCreate(node) || canCreateDeclaration(node) || canDelete(node)"
                    class="dropdown-menu dropdown-menu-fixed shadow" id="context-menu-{{node.id  | replaceSpaces}}">

                    <div *ngIf="canCreate(node) || canCreateDeclaration(node)">
                      <a (click)="onAddNode(node, 'block')" class="dropdown-item" href="#">New block</a>
                      <a (click)="onAddNode(node, 'declaration')" class="dropdown-item" href="#">New declaration</a>

                      <div *ngIf="canDelete(node)" class="dropdown-divider" href="#"></div>
                    </div>

                    <a (click)="onDeleteNode(node)" *ngIf="canDelete(node)" class="dropdown-item" href="#">
                      <i class="fas fa-minus"></i>
                      Delete
                    </a>
                  </div> -->

                  <!-- <div *ngIf="node.data.actions">
                    Actions: {{ node.data.actions }}
                  </div> -->

                  <div *ngIf="node.data.actions ? true : false" class="dropdown-menu dropdown-menu-fixed shadow"
                    id="context-menu-{{node.id | replaceSpaces}}">

                    <a *ngIf="node.data.actions.includes('block')" (click)="onAddNode(node, 'block')"
                      class="dropdown-item" href="#">New block</a>
                    <a *ngIf="node.data.actions.includes('declaration')" (click)="onAddNode(node, 'declaration')"
                      class="dropdown-item" href="#">New declaration</a>
                    <a *ngIf="node.data.actions.includes('page')" (click)="onAddNode(node, 'page')"
                      class="dropdown-item" href="#">New page</a>

                    <div *ngIf="node.data.actions.length > 1" class="dropdown-divider" href="#"></div>

                    <a *ngIf="node.data.actions.includes('delete')" (click)="onDeleteNode(node)" class="dropdown-item"
                      href="#">Delete</a>
                  </div>

                </div>

              </ng-template>
            </tree-root>
            <!------------------->

          </div>
        </div>
      </div>
    </div>
  </tab>


  <tab [id]="'Application settings'" [tabTitle]="'Application settings'">
    <table [id]="'application-settings-table'" class="table table-bordered table-hover table-small"
      *ngIf="showTable !== 'application-settings-table'">
      <tr *ngFor="let item of appSettingsKeys">
        <td width="50%" class="valueName">{{ item}}</td>
        <td width="50%" contenteditable='true'>{{ appSettings[item] }}</td>
      </tr>
    </table>
  </tab>
</tabs>