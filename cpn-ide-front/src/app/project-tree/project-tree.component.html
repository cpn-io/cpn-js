<div id="projectTreeComponentContainer" style="width: 100%; height: 100%;">

  <!-- Project tree toolbar -->
  <app-project-tree-toolbar (newNode)="onNewNode()" (deleteNode)="onDeleteNode()" (upNode)="onUpNode()"
    (downNode)="onDownNode()">
    <!-- <app-project-tree-toolbar> -->
  </app-project-tree-toolbar>

  <div class="tab-container-with-toolbar">

    <ng-container *ngIf="cpnet">

      <div id="tree" class="tree" (keydown)="onKeyDown($event)" (click)="disableContextMenu()"
        oncontextmenu="return false;">

        <!-- Project root -->
        <app-tree-node [tree]="tree" id="project" type="root" [title]="'Project: ' + project.name" [showBullet]="false">

          <div class="node" [textContent]="'Step: ' + simulationState.step"></div>
          <div class="node" [textContent]="'Time: ' + simulationState.time"></div>

          <!-- Options -->
          <app-tree-node [tree]="tree" id="options" title="Options" type="options">

            <app-project-tree-options-node [tree]="tree" [optionList]="nodeToArray(cpnet.options.option)">
            </app-project-tree-options-node>

          </app-tree-node>


          <!-- Declarations -->
          <app-tree-node [tree]="tree" id="declarations" type="declarations" title="Declarations"
            (contextmenu)="onRightClick($event)">

            <ng-container *ngFor="let globbox of nodeToArray(cpnet.globbox)">
              <ng-container *ngFor="let block of nodeToArray(globbox.block)">
                <app-project-tree-block-node [tree]="tree" [block]="block">
                </app-project-tree-block-node>
              </ng-container>
            </ng-container>

          </app-tree-node>


          <!-- Monitors -->
          <app-project-tree-monitorblock-node [tree]="tree" [monitorblock]="cpnet.monitorblock">
          </app-project-tree-monitorblock-node>

          <!-- Pages -->
          <app-tree-node [tree]="tree" id="pages" title="Pages" [type]="'root'" [cpnElement]="undefined"
            (contextmenu)="onRightClick($event)">

            <ng-container *ngFor="let page of tree.pages">
              <ng-container *ngIf="!tree.subpages.includes(page._id)">
                <app-project-tree-page-node [tree]="tree" [page]="page">
                </app-project-tree-page-node>
              </ng-container>
            </ng-container>

          </app-tree-node>

        </app-tree-node>

      </div>

    </ng-container>
  </div>


  <!-- Tree node context menu -->
  <!-- <div *ngIf="contextmenu">
  <app-context-menu [x]="contextmenuX" [y]="contextmenuY">
    <a *ngIf="selected && ['globref', 'color', 'var', 'ml', 'block'].includes(selected.type)" class="dropdown-item"
      href="#" (click)="onNewDeclaration()">New declaration</a>
    <a *ngIf="selected && ['globref', 'color', 'var', 'ml', 'block'].includes(selected.type)" class="dropdown-item"
      href="#" (click)="onNewBlock()">New block</a>
    <a *ngIf="selected && ['page'].includes(selected.type)" class="dropdown-item" href="#" (click)="onNewPage()">New
      page</a>
  </app-context-menu>
</div> -->

  <app-context-menu #contextMenu></app-context-menu>

</div>